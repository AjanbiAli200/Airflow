apiVersion: v1
kind: ConfigMap
metadata:
  name: airflow-config
  namespace: airflow-ns
data:
  airflow.cfg: |
    [core]
    executor = KubernetesExecutor
    dags_folder = /opt/airflow/dags

    [database]  # Using [database] per deprecation warning
    sql_alchemy_conn = postgresql+psycopg2://airflow:airflow@postgres:5432/airflow
  airflow_settings.yaml: |
    airflow:
      core:
        executor: KubernetesExecutor
      connections:
        - conn_id: minio_default
          conn_type: s3
          conn_host: http://minio:9000
          conn_login: minio
          conn_password: minio123
          conn_extra:
            host: http://minio:9000
        - conn_id: spark_default
          conn_type: spark
          conn_host: spark://spark-master:7077
      pools:
        - pool_name: default_pool
          pool_slot: 128
          pool_description: Default pool for tasks
      variables:
        - variable_name: minio_bucket
          variable_value: my-bucket